import tkinter as tk
from tkinter import messagebox
from textblob import TextBlob
import datetime
import random

# --- Motivational Quotes with Emojis ---
quotes = {
    "happy": [
        "Smile big ðŸ˜Š Laugh loud ðŸ˜‚ Shine bright âœ¨",
        "Youâ€™re glowing today! ðŸŒŸ Keep spreading sunshine â˜€",
        "Dance like nobodyâ€™s watching ðŸ’ƒðŸŽ¶ Be your happiest self!",
        "Joy is in the little things ðŸŒ¸âœ¨",
        "Keep that sparkle in your soul âœ¨ and a smile on your face ðŸ˜Š"
    ],
    "sad": [
        "It's okay to not be okay ðŸ˜” Just take a deep breath ðŸŒ¬ and start again ðŸŒ±",
        "Even the darkest night will end ðŸŒŒ and the sun will rise again â˜€",
        "Crying doesnâ€™t make you weak ðŸ˜¢ It means youâ€™ve been strong for too long ðŸ’—",
        "Pause. Breathe. Trust. ðŸŒ¬ðŸ’– Youâ€™re doing better than you think.",
        "Sending you a virtual hug ðŸ¤— Youâ€™re not alone."
    ],
    "anxious": [
        "Breathe in calm ðŸŒ¬ Breathe out stress ðŸ˜®â€ðŸ’¨ Youâ€™ve got this ðŸ’ª",
        "One step at a time ðŸ‘£ You donâ€™t need to figure it all out today ðŸ•Š",
        "Itâ€™s okay to pause â¸ Rest is also part of progress ðŸŒ±",
        "Let go of what you canâ€™t control ðŸ•Š Focus on your next small move ðŸŽ¯",
        "Be kind to yourself ðŸ’– Youâ€™re trying your best and thatâ€™s enough ðŸŒ·"
    ],
    "neutral": [
        "Not every day needs to be exciting âœ¨ Peace is also beautiful ðŸŒ¿",
        "Take it slow today ðŸ¢ Youâ€™re allowed to just be ðŸ¤",
        "Be present ðŸ•° Not perfect ðŸŒ¼",
        "Breathe. Pause. Repeat. ðŸŒ¬ Sometimes stillness is progress too â³",
        "Youâ€™re doing fine â€” even if nothing big is happening today ðŸŒ¸"
    ]
}

# --- Detect Mood from Text ---
def detect_mood(text):
    blob = TextBlob(text)
    polarity = blob.sentiment.polarity
    if polarity > 0.3:
        return "happy"
    elif polarity < -0.3:
        return "sad"
    elif -0.3 <= polarity <= 0.3 and len(text.strip()) > 3:
        return "anxious"
    else:
        return "neutral"

# --- Analyze and Display Mood ---
def check_mood():
    user_input = entry.get()
    if not user_input.strip():
        messagebox.showwarning("Warning", "Please type something.")
        return

    mood = detect_mood(user_input)
    quote = random.choice(quotes[mood])

    result_label.config(text=f"Mood: {mood.upper()}\n\n\"{quote}\"")

    # Define text-friendly colors for black background
    colors = {
        "happy": "#FFD700",     # gold
        "sad": "#87CEEB",       # sky blue
        "anxious": "#D3D3D3",   # light grey
        "neutral": "#FFFFFF"    # white
    }

    text_color = colors[mood]
    window.config(bg="black")
    title_label.config(bg="black", fg=text_color)
    result_label.config(bg="black", fg=text_color)
    entry.config(bg="#1e1e1e", fg=text_color, insertbackground=text_color)
    check_button.config(bg="#444444", fg="white", activebackground="#666666")

    # Log entry
    now = datetime.datetime.now().strftime("%d-%m-%Y %I:%M %p")
    with open("mood_log.txt", "a") as log_file:
        log_file.write(f"[{now}] Mood: {mood.capitalize()} â†’ \"{user_input.strip()}\"\n")

# --- Tkinter GUI Setup ---
window = tk.Tk()
window.title("MoodMirror - Emotion Assistant")
window.geometry("420x320")
window.config(bg="black")

title_label = tk.Label(window, text="MoodMirror ðŸªž", font=("Arial", 16, "bold"), bg="black", fg="white")
title_label.pack(pady=10)

entry = tk.Entry(window, width=50, bg="#1e1e1e", fg="white", insertbackground="white")
entry.pack(pady=10)

check_button = tk.Button(window, text="Check Mood", command=check_mood, bg="#444444", fg="white", activebackground="#666666")
check_button.pack(pady=5)

result_label = tk.Label(window, text="", font=("Arial", 12), bg="black", fg="white", wraplength=380, justify="center")
result_label.pack(pady=20)

window.mainloop()
